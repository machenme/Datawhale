# Datawhale AI 夏令营-电力需求预测赛

学习者手册:https://exn8g66dnwu.feishu.cn/docx/T7WGd7goqowRvFxwoApclo9Pn0b

赛事地址(数据集下载):https://challenge.xfyun.cn/topic/info?type=electricity-demand&option=ssgy&ch=dw24_uGS8Gs


<details>

<summary>task1:初步了解项目</summary>

### 数据类型

赛题数据由训练集和测试集组成，为了保证比赛的公平性，将每日日期进行脱敏，用1-N进行标识，即1为数据集最近一天，其中1-10为测试集数据。

|特征字段|	字段描述|
|--|--|
|id	|房屋id|
|dt	|日标识|
|type	|房屋类型|
|target	|实际电力消耗，预测目标|

### 完整代码:

```python
# 1. 导入需要用到的相关库
# 导入 pandas 库，用于数据处理和分析
import pandas as pd
# 导入 numpy 库，用于科学计算和多维数组操作
import numpy as np

# 2. 读取训练集和测试集
# 使用 read_csv() 函数从文件中读取训练集数据，文件名为 'train.csv'
train = pd.read_csv('./data/data283931/train.csv')
# 使用 read_csv() 函数从文件中读取测试集数据，文件名为 'train.csv'
test = pd.read_csv('./data/data283931/test.csv')

# 3. 计算训练数据最近11-20单位时间内对应id的目标均值
target_mean = train[train['dt']<=20].groupby(['id'])['target'].mean().reset_index()

# 4. 将target_mean作为测试集结果进行合并
test = test.merge(target_mean, on=['id'], how='left')

# 5. 保存结果文件到本地
test[['id','dt','target']].to_csv('submit.csv', index=None)
```

### 学习代码

```python
target_mean = train[train['dt']<=20].groupby(['id'])['target'].mean().reset_index()
```
- `train[train['dt']<=20]`读取`train`中`dt`列小于等于20的所有数据

- `groupby`函数将数据进行分组然后再进行下一步操作
    - 通过`groupby(['id'])`告诉系统以`id`这列数据进行分组,`id`相同的数据均会被分到一个组里.
    - `groupby(['id'])['target']`则是分组之后只需要`target`这列数据
    - `groupby(['id'])['target'].mean()`获取每个分组的`target`的平均值
- `reset_index()`重建数据索引

```python
test = test.merge(target_mean, on=['id'], how='left')
```
`merge`函数用来合并两个DateFrame
- `df1.merge(df2)`与`pd.merge(df1,df2)`是等价的,都是合并`df1`与`df2`数据
- `on`以哪一列作为合并的依据,这里以`id`列作为合并的依据
- `how`如何合并,`left`保留左侧df1的所有行，如果右侧df2中没有匹配的键，则相应的列将填充为 NaN
    - `right`以右侧为准,如果左侧没有对应的数据填充NaN
    - `inner`取交集,合并后的数据只有左右两个df都有的部分
    - `outer`取并集,保留二者所有行,没有的部分填充NaN

显然我们不能够简单的用过去11天到20天的平均值作为过去1到10天的预测依据.我们应该找到更好的预测手段.

</details>
